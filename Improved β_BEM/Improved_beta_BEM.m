%% beta-BEM theory program
    clear all; clc
    
% Input wind turbine
    alpha_data = [-180; -177.71; -175.43; -173.14; -170.86; -168.57; -166.29; -164; -161.71; -159.43; -157.14; -154.86; -152.57; -150.29; -148; -143.86; -139.71; -135.57; -131.43; -127.29; -123.14; -119; -114.86; -110.71; -106.57; -102.43; -98.29; -94.14; -90; -85.86; -81.71; -77.57; -73.43; -69.29; -65.14; -61; -56.86; -52.71; -48.57; -44.43; -40.29; -36.14; -32; -28; -24; -20; -18; -16; -14; -12; -10; -8; -6; -4; -2; -1; 0; 1; 2; 3; 4; 5; 6; 7; 8; 9; 10; 11; 12; 13; 14; 15; 16; 18; 20; 24; 28; 32; 36.14; 40.29; 44.43; 48.57; 52.71; 56.86; 61; 65.14; 69.29; 73.43; 77.57; 81.71; 85.86; 90; 94.14; 98.29; 102.43; 106.57; 110.71; 114.86; 119; 123.14; 127.29; 131.43; 135.57; 139.71; 143.86; 148; 150.29; 152.57; 154.86; 157.14; 159.43; 161.71; 164; 166.29; 168.57; 170.86; 173.14; 175.43; 177.71; 180];
    span=[3;5.34;7.77551;10.16327;12.55102;14.93878;17.32653;20.55;22.10204;24.4898;26.87755;29.26531;31.6849;34.04082;36.42857;38.81633;41.4747;43.59184;45.97959;48.36735;50.7551;54.384;57.91837;60.30612;62.69388;65.9076;67.46939;69.85714;72.2449;74.63265;77.6703;79.40816;81.79592;84.18367;86.57143;88.95918;91.34694;93.294;96.12245;98.5102;100.898;103.2857;105.6735;108.0612;110.449;112.8367;115.2245;117.6122;118.83;120]; % span [m]
    twist=[15.59455;15.5911;15.41083;14.94856;14.25845;13.39714;12.42202;11.0323;10.37098;9.404;8.551522;7.833153;7.1829;6.551629;5.933996;5.34609;4.7344;4.296594;3.846955;3.445342;3.076914;2.561;2.111691;1.828396;1.558783;1.2156;1.064427;0.843446;0.636564;0.437029;0.186;0.039678;-0.17283;-0.40708;-0.68038;-0.99929;-1.32053;-1.5751;-1.88437;-2.08623;-2.164;-2.17584;-2.1553;-2.10291;-2.0184;-1.89674;-1.72433;-1.50813;-1.37947;-1.24239]; % twist [deg]
    c=[5.2;5.2083;5.237887;5.293325;5.36734;5.452093;5.540032;5.6501;5.692531;5.742611;5.764837;5.75612;5.7023;5.604676;5.471559;5.322778;5.1487;5.019421;4.885808;4.76796;4.654566;4.4821;4.316959;4.207881;4.101646;3.9635;3.899409;3.803173;3.709389;3.617112;3.5008;3.434083;3.341933;3.248678;3.15611;3.06458;2.972993;2.898;2.786969;2.691031;2.591966;2.489324;2.383917;2.275924;2.165467;2.052625;1.937753;1.819663;1.707787;0.5]; % chord [m]
    nB=3; % number of blade
    beta=0; % precone angle [deg]
    pitch=0; % pitch angle [deg]
    V0=10.59; % inflow velocity [m/s]
    omega=7.56; % rotor speed [rpm]
    phi=zeros(size(span),1); % incidence angle [deg]
    alpha=zeros(size(span),1); % angle of attack [deg]
    Re=zeros(size(span),1);% Reynolds number
    F=zeros(size(span),1); % Prandtl tip loss factor
    a=zeros(size(span),1);%  axial induction factors
    a_=zeros(size(span),1);% tangential induction factors
    Cl=zeros(size(span),1); % lift coefficient
    Cd=zeros(size(span),1); % drag coefficient
    pN=zeros(size(span),1); % axial component of normal force [kN]
    pT=zeros(size(span),1); % tangential force [kN]
    Cn=zeros(size(span),1); % axial component of normal force coefficient
    Ct=zeros(size(span),1); % tangential force coefficient
    Cl_data=zeros(120,size(span));
    Cd_data=zeros(120,size(span));
   
    % cylinder
    Cl_data_cylinder=zeros(120,1);
    Cd_data_cylinder=[0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35;0.35];
    
    % SNL-FFA-W3-500
    Cl_data_500 = [0.0000; 0.0782; 0.1741; 0.2832; 0.3991; 0.5174; 0.6316; 0.7375; 0.8289; 0.9003; 0.9491; 0.9758; 0.9823; 0.9700; 0.9406; 0.8605; 0.7741; 0.7057; 0.6485; 0.5902; 0.5273; 0.4624; 0.3968; 0.3301; 0.2623; 0.1943; 0.1278; 0.0632; -0.0003; -0.0637; -0.1284; -0.1948; -0.2628; -0.3307; -0.3975; -0.4629; -0.5272; -0.5899; -0.6498; -0.7093; -0.7752; -0.8522; -0.9318; -0.9993; -1.0397; -1.0281; -0.9814; -0.9405; -0.8925; -0.8270; -0.7673; -0.5716; -0.3143; -0.0528; 0.1854; 0.3006; 0.4135; 0.5357; 0.6568; 0.7758; 0.8925; 1.0080; 1.1211; 1.2310; 1.3370; 1.4409; 1.5248; 1.5965; 1.6379; 1.6867; 1.7241; 1.7571; 1.7702; 1.7354; 1.6684; 1.5856; 1.4422; 1.3182; 1.2101; 1.1038; 1.0165; 0.9294; 0.8419; 0.7528; 0.6616; 0.5678; 0.4723; 0.3764; 0.2797; 0.1816; 0.0855; 0.0003; -0.0687; -0.1297; -0.1930; -0.2613; -0.3302; -0.3971; -0.4624; -0.5271; -0.5901; -0.6485; -0.7057; -0.7741; -0.8605; -0.9406; -0.9700; -0.9823; -0.9758; -0.9491; -0.9003; -0.8289; -0.7374; -0.6316; -0.5173; -0.3990; -0.2831; -0.1740; -0.0781; 0.0000];
    Cd_data_500 = [0.0844; 0.087407529; 0.087400104; 0.085934292; 0.08457047; 0.084853307; 0.088327908; 0.096581383; 0.111168956; 0.133524731; 0.164250773; 0.201362917; 0.243227438; 0.287530832; 0.33295056; 0.41673258; 0.503765608; 0.593919235; 0.685275948; 0.775289467; 0.862278617; 0.944367767; 1.020203059; 1.088130126; 1.146204011; 1.194451085; 1.233249033; 1.260483744; 1.270699825; 1.260327904; 1.23297621; 1.194086985; 1.145752747; 1.087622608; 1.019672039; 0.943743581; 0.861411455; 0.774317658; 0.684798223; 0.594138115; 0.503196608; 0.413223829; 0.329340812; 0.259011858; 0.200201745; 0.149852668; 0.135978847; 0.122874728; 0.110983803; 0.101292315; 0.09249112; 0.087498697; 0.0851995; 0.083999965; 0.083799865; 0.0838; 0.0838; 0.084003068; 0.084199111; 0.084481272; 0.084703647; 0.085135014; 0.085534095; 0.085990241; 0.086524328; 0.087186716; 0.087999792; 0.088948105; 0.090828123; 0.09322465; 0.096871674; 0.1014833; 0.108087465; 0.12815303; 0.152759845; 0.198353667; 0.265341642; 0.341372875; 0.42396193; 0.507780329; 0.596570398; 0.685224478; 0.773596907; 0.86092108; 0.94384447; 1.019862594; 1.087648891; 1.145697561; 1.19405998; 1.23298702; 1.260340089; 1.270699865; 1.26047977; 1.233247708; 1.194452033; 1.146204752; 1.088130024; 1.020202787; 0.944367714; 0.862278692; 0.775289509; 0.685275935; 0.593919217; 0.503765607; 0.416732586; 0.332950563; 0.287530832; 0.243227437; 0.201362916; 0.164250772; 0.133524731; 0.111168956; 0.096581384; 0.088327908; 0.084853307; 0.08457047; 0.085934292; 0.087400103; 0.087407528; 0.0844];
    
    % FFA-W3-360
    Cl_data_360 = [0; 0.0717; 0.1435; 0.2153; 0.2871; 0.3589; 0.4306; 0.5024; 0.5742; 0.646; 0.7178; 0.7896; 0.8613; 0.9331; 1.0049; 0.9189; 0.844; 0.7748; 0.7079; 0.6411; 0.5733; 0.5038; 0.4326; 0.3598; 0.286; 0.212; 0.1389; 0.0678; 0; -0.0678; -0.1389; -0.212; -0.286; -0.3598; -0.4326; -0.5038; -0.5733; -0.6411; -0.7079; -0.7748; -0.844; -0.9189; -1.0049; -1.113; -1.0542; -0.9824; -0.9417; -0.8933; -0.8547; -0.8234; -0.7954; -0.6365; -0.3909; -0.1307; 0.1617; 0.3112; 0.4595; 0.6056; 0.7486; 0.8886; 1.0254; 1.1587; 1.2882; 1.4128; 1.5309; 1.6406; 1.7392; 1.8197; 1.8706; 1.8922; 1.8791; 1.8811; 1.8635; 1.7332; 1.5935; 1.467; 1.4483; 1.4356; 1.3128; 1.2058; 1.1069; 1.0112; 0.9159; 0.819; 0.7198; 0.618; 0.514; 0.4086; 0.3029; 0.1985; 0.0969; 0; -0.0678; -0.1389; -0.212; -0.286; -0.3598; -0.4326; -0.5038; -0.5733; -0.6411; -0.7079; -0.7748; -0.844; -0.9189; -1.0049; -0.9331; -0.8613; -0.7896; -0.7178; -0.646; -0.5742; -0.5024; -0.4306; -0.3589; -0.2871; -0.2153; -0.1435; -0.0717; 0];
    Cd_data_360 = [0.0371; 0.0377; 0.0395; 0.0424; 0.0465; 0.0517; 0.0606; 0.0865; 0.1158; 0.1485; 0.1843; 0.2231; 0.2645; 0.3083; 0.3542; 0.4419; 0.5337; 0.6279; 0.7223; 0.8152; 0.9044; 0.9882; 1.0649; 1.1328; 1.1906; 1.237; 1.2711; 1.2922; 1.3; 1.2922; 1.2711; 1.237; 1.1906; 1.1328; 1.0649; 0.9882; 0.9044; 0.8152; 0.7223; 0.6279; 0.5337; 0.4419; 0.3542; 0.2049; 0.1543; 0.1096; 0.0924; 0.0759; 0.0605; 0.0464; 0.0344; 0.0254; 0.0199; 0.0165; 0.015; 0.0147; 0.0146; 0.0146; 0.0148; 0.015; 0.0154; 0.0159; 0.0165; 0.0173; 0.0183; 0.0196; 0.0215; 0.0244; 0.0296; 0.0377; 0.0482; 0.0583; 0.0699; 0.1016; 0.1391; 0.21; 0.282; 0.3542; 0.4419; 0.5337; 0.6279; 0.7223; 0.8152; 0.9044; 0.9882; 1.0649; 1.1328; 1.1906; 1.237; 1.2711; 1.2922; 1.3; 1.2922; 1.2711; 1.237; 1.1906; 1.1328; 1.0649; 0.9882; 0.9044; 0.8152; 0.7223; 0.6279; 0.5337; 0.4419; 0.3542; 0.3083; 0.2645; 0.2231; 0.1843; 0.1485; 0.1158; 0.0865; 0.0606; 0.0517; 0.0465; 0.0424; 0.0395; 0.0377; 0.0371];
    
    % FFA-W3-330blend
     Cl_data_330 = [0; 0.0696; 0.1392; 0.2088; 0.2784; 0.348; 0.4176; 0.4872; 0.5568; 0.6264; 0.696; 0.7656; 0.8352; 0.9048; 0.9744; 0.8941; 0.8238; 0.7584; 0.6947; 0.6307; 0.5653; 0.4978; 0.4282; 0.3568; 0.2841; 0.211; 0.1385; 0.0677; 0; -0.0677; -0.1385; -0.211; -0.2841; -0.3568; -0.4282; -0.4978; -0.5653; -0.6307; -0.6947; -0.7584; -0.8238; -0.8941; -0.9744; -1.163; -1.1489; -1.0945; -1.058; -1.0228; -0.9981; -0.9851; -0.8958; -0.6753; -0.4324; -0.1588; 0.1345; 0.2801; 0.4238; 0.5651; 0.7041; 0.8407; 0.975; 1.1068; 1.236; 1.3622; 1.4842; 1.6009; 1.7101; 1.8095; 1.8947; 1.9569; 1.9857; 1.9926; 1.9961; 1.9639; 1.8117; 1.5607; 1.4679; 1.392; 1.2773; 1.1768; 1.0835; 0.9925; 0.9011; 0.8076; 0.7111; 0.6117; 0.5097; 0.4058; 0.3014; 0.1978; 0.0967; 0; -0.0677; -0.1385; -0.211; -0.2841; -0.3568; -0.4282; -0.4978; -0.5653; -0.6307; -0.6947; -0.7584; -0.8238; -0.8941; -0.9744; -0.9048; -0.8352; -0.7656; -0.696; -0.6264; -0.5568; -0.4872; -0.4176; -0.348; -0.2784; -0.2088; -0.1392; -0.0696; 0];
     Cd_data_330 = [0.0316; 0.0322; 0.034; 0.037; 0.0411; 0.0463; 0.0573; 0.0831; 0.1125; 0.1453; 0.1812; 0.22; 0.2614; 0.3053; 0.3513; 0.4391; 0.5311; 0.6254; 0.7201; 0.8131; 0.9025; 0.9865; 1.0634; 1.1316; 1.1896; 1.2362; 1.2706; 1.292; 1.3; 1.292; 1.2706; 1.2362; 1.1896; 1.1316; 1.0634; 0.9865; 0.9025; 0.8131; 0.7201; 0.6254; 0.5311; 0.4391; 0.3513; 0.2064; 0.15; 0.106; 0.0873; 0.0705; 0.0547; 0.0405; 0.0292; 0.022; 0.0173; 0.0147; 0.0136; 0.0133; 0.0133; 0.0133; 0.0134; 0.0136; 0.0139; 0.0143; 0.0148; 0.0154; 0.0162; 0.0171; 0.0184; 0.0201; 0.0225; 0.0267; 0.0338; 0.0433; 0.0535; 0.077; 0.1116; 0.191; 0.2719; 0.3513; 0.4391; 0.5311; 0.6254; 0.7201; 0.8131; 0.9025; 0.9865; 1.0634; 1.1316; 1.1896; 1.2362; 1.2706; 1.292; 1.3; 1.292; 1.2706; 1.2362; 1.1896; 1.1316; 1.0634; 0.9865; 0.9025; 0.8131; 0.7201; 0.6254; 0.5311; 0.4391; 0.3513; 0.3053; 0.2614; 0.22; 0.1812; 0.1453; 0.1125; 0.0831; 0.0573; 0.0463; 0.0411; 0.037; 0.034; 0.0322; 0.0316];
    
     % FFA-W3-301
     Cl_data_301 = [0; 0.065; 0.1301; 0.1952; 0.2603; 0.3254; 0.3904; 0.4555; 0.5206; 0.5857; 0.6508; 0.7159; 0.7809; 0.846; 0.9111; 0.8425; 0.7818; 0.7244; 0.6675; 0.6092; 0.5486; 0.4853; 0.4191; 0.3505; 0.2801; 0.2088; 0.1375; 0.0675; 0; -0.0675; -0.1375; -0.2088; -0.2801; -0.3505; -0.4191; -0.4853; -0.5486; -0.6092; -0.6675; -0.7244; -0.7818; -0.8425; -0.9111; -1.1034; -1.1073; -1.1181; -1.1233; -1.1186; -1.1162; -1.0958; -0.9176; -0.6931; -0.4539; -0.1777; 0.1048; 0.2438; 0.3811; 0.5166; 0.6504; 0.7826; 0.9132; 1.042; 1.1687; 1.2929; 1.4139; 1.5308; 1.642; 1.7456; 1.8388; 1.9176; 1.9741; 1.9991; 1.9937; 1.9172; 1.7368; 1.4732; 1.3601; 1.3016; 1.2036; 1.1169; 1.0349; 0.9536; 0.8704; 0.7838; 0.6932; 0.5987; 0.5008; 0.4002; 0.2983; 0.1964; 0.0964; 0; -0.0675; -0.1375; -0.2088; -0.2801; -0.3505; -0.4191; -0.4853; -0.5486; -0.6092; -0.6675; -0.7244; -0.7818; -0.8425; -0.9111; -0.846; -0.7809; -0.7159; -0.6508; -0.5857; -0.5206; -0.4555; -0.3904; -0.3254; -0.2603; -0.1952; -0.1301; -0.065; 0];
     Cd_data_301 = [0.0245; 0.0251; 0.0269; 0.0299; 0.034; 0.0393; 0.0591; 0.0849; 0.1143; 0.147; 0.1829; 0.2216; 0.263; 0.3069; 0.3528; 0.4406; 0.5325; 0.6267; 0.7213; 0.8142; 0.9035; 0.9874; 1.0642; 1.1322; 1.1901; 1.2366; 1.2709; 1.2921; 1.3; 1.2921; 1.2709; 1.2366; 1.1901; 1.1322; 1.0642; 0.9874; 0.9035; 0.8142; 0.7213; 0.6267; 0.5325; 0.4406; 0.3528; 0.2172; 0.1562; 0.1033; 0.0818; 0.0633; 0.0471; 0.0328; 0.0235; 0.0179; 0.0143; 0.0124; 0.0116; 0.0114; 0.0113; 0.0114; 0.0115; 0.0117; 0.012; 0.0123; 0.0128; 0.0133; 0.014; 0.0148; 0.0159; 0.0172; 0.019; 0.0216; 0.0257; 0.0322; 0.0415; 0.0673; 0.1052; 0.1922; 0.2744; 0.3528; 0.4406; 0.5325; 0.6267; 0.7213; 0.8142; 0.9035; 0.9874; 1.0642; 1.1322; 1.1901; 1.2366; 1.2709; 1.2921; 1.3; 1.2921; 1.2709; 1.2366; 1.1901; 1.1322; 1.0642; 0.9874; 0.9035; 0.8142; 0.7213; 0.6267; 0.5325; 0.4406; 0.3528; 0.3069; 0.263; 0.2216; 0.1829; 0.147; 0.1143; 0.0849; 0.0591; 0.0393; 0.034; 0.0299; 0.0269; 0.0251; 0.0245];
     
     % FFA-W3-270blend
     Cl_data_270 = [0; 0.0621; 0.1242; 0.1863; 0.2485; 0.3106; 0.3727; 0.4349; 0.497; 0.5591; 0.6212; 0.6834; 0.7455; 0.8076; 0.8698; 0.8166; 0.7681; 0.7204; 0.6709; 0.6182; 0.5615; 0.5005; 0.4354; 0.3665; 0.2947; 0.2209; 0.1463; 0.0722; 0; -0.0722; -0.1463; -0.2209; -0.2947; -0.3665; -0.4354; -0.5005; -0.5615; -0.6182; -0.6709; -0.7204; -0.7681; -0.8166; -0.8698; -1.0983; -1.0833; -1.0699; -1.0545; -1.0343; -1.0836; -1.0948; -0.9266; -0.6967; -0.4362; -0.1625; 0.107; 0.2399; 0.3715; 0.5021; 0.6313; 0.7595; 0.8863; 1.0117; 1.1343; 1.2553; 1.3737; 1.4884; 1.5978; 1.7; 1.7919; 1.8678; 1.9268; 1.909; 1.8854; 1.721; 1.5473; 1.3717; 1.3361; 1.2425; 1.1665; 1.0973; 1.0291; 0.9585; 0.8832; 0.8022; 0.7151; 0.622; 0.5236; 0.421; 0.3156; 0.2091; 0.1032; 0; -0.0722; -0.1463; -0.2209; -0.2947; -0.3665; -0.4354; -0.5005; -0.5615; -0.6182; -0.6709; -0.7204; -0.7681; -0.8166; -0.8698; -0.8076; -0.7455; -0.6834; -0.6212; -0.5591; -0.497; -0.4349; -0.3727; -0.3106; -0.2485; -0.1863; -0.1242; -0.0621; 0];
     Cd_data_270 = [0.0154; 0.0161; 0.018; 0.0213; 0.0258; 0.0328; 0.0568; 0.0847; 0.1164; 0.1517; 0.1904; 0.2323; 0.277; 0.3244; 0.374; 0.4688; 0.5681; 0.6699; 0.7721; 0.8725; 0.9692; 1.06; 1.1431; 1.2168; 1.2796; 1.3303; 1.3676; 1.391; 1.4; 1.391; 1.3676; 1.3303; 1.2796; 1.2168; 1.1431; 1.06; 0.9692; 0.8725; 0.7721; 0.6699; 0.5681; 0.4688; 0.374; 0.2188; 0.1598; 0.1074; 0.0869; 0.0684; 0.0473; 0.0308; 0.0198; 0.0143; 0.0115; 0.0102; 0.0097; 0.0096; 0.0096; 0.0097; 0.0099; 0.0101; 0.0104; 0.0108; 0.0114; 0.0119; 0.0126; 0.0135; 0.0146; 0.0159; 0.0177; 0.0203; 0.0238; 0.0323; 0.0425; 0.0767; 0.1191; 0.2018; 0.2798; 0.374; 0.4688; 0.5681; 0.6699; 0.7721; 0.8725; 0.9692; 1.06; 1.1431; 1.2168; 1.2796; 1.3303; 1.3676; 1.391; 1.4; 1.391; 1.3676; 1.3303; 1.2796; 1.2168; 1.1431; 1.06; 0.9692; 0.8725; 0.7721; 0.6699; 0.5681; 0.4688; 0.374; 0.3244; 0.277; 0.2323; 0.1904; 0.1517; 0.1164; 0.0847; 0.0568; 0.0328; 0.0258; 0.0213; 0.018; 0.0161; 0.0154];
 
     % FFA-W3-241
     Cl_data_241 = [0; 0.0581; 0.1163; 0.1745; 0.2327; 0.2908; 0.349; 0.4072; 0.4654; 0.5236; 0.5817; 0.6399; 0.6981; 0.7563; 0.8144; 0.7792; 0.7451; 0.7088; 0.6683; 0.6225; 0.5708; 0.513; 0.4496; 0.3811; 0.3084; 0.2326; 0.155; 0.0769; 0; -0.0769; -0.155; -0.2326; -0.3084; -0.3811; -0.4496; -0.513; -0.5708; -0.6225; -0.6683; -0.7088; -0.7451; -0.7792; -0.8144; -1.0778; -1.1269; -1.1448; -1.1279; -1.0939; -1.0596; -1.0312; -0.937; -0.6738; -0.4039; -0.1422; 0.1158; 0.2438; 0.3711; 0.4976; 0.6233; 0.7479; 0.8713; 0.9932; 1.1132; 1.2303; 1.3449; 1.454; 1.5591; 1.6577; 1.7483; 1.8266; 1.8883; 1.9257; 1.9272; 1.8005; 1.6308; 1.4334; 1.288; 1.1635; 1.1132; 1.0644; 1.0125; 0.9547; 0.8893; 0.8154; 0.7329; 0.6423; 0.5445; 0.4406; 0.3323; 0.2214; 0.1099; 0; -0.0769; -0.155; -0.2326; -0.3084; -0.3811; -0.4496; -0.513; -0.5708; -0.6225; -0.6683; -0.7088; -0.7451; -0.7792; -0.8144; -0.7563; -0.6981; -0.6399; -0.5817; -0.5236; -0.4654; -0.4072; -0.349; -0.2908; -0.2327; -0.1745; -0.1163; -0.0581; 0];
     Cd_data_241 = [0.0117; 0.0124; 0.0146; 0.0181; 0.023; 0.0292; 0.0538; 0.0837; 0.1178; 0.1558; 0.1974; 0.2423; 0.2904; 0.3412; 0.3946; 0.4964; 0.6031; 0.7126; 0.8224; 0.9305; 1.0344; 1.1322; 1.2217; 1.3012; 1.369; 1.4237; 1.4643; 1.4899; 1.5; 1.4899; 1.4643; 1.4237; 1.369; 1.3012; 1.2217; 1.1322; 1.0344; 0.9305; 0.8224; 0.7126; 0.6031; 0.4964; 0.3946; 0.2225; 0.1515; 0.0969; 0.0774; 0.0612; 0.0466; 0.033; 0.0202; 0.0116; 0.0091; 0.0083; 0.0081; 0.008; 0.0081; 0.0082; 0.0084; 0.0086; 0.009; 0.0094; 0.0099; 0.0107; 0.0115; 0.0126; 0.0139; 0.0154; 0.0172; 0.0196; 0.0229; 0.0279; 0.036; 0.0653; 0.1045; 0.1914; 0.2862; 0.3946; 0.4964; 0.6031; 0.7126; 0.8224; 0.9305; 1.0344; 1.1322; 1.2217; 1.3012; 1.369; 1.4237; 1.4643; 1.4899; 1.5; 1.4899; 1.4643; 1.4237; 1.369; 1.3012; 1.2217; 1.1322; 1.0344; 0.9305; 0.8224; 0.7126; 0.6031; 0.4964; 0.3946; 0.3412; 0.2904; 0.2423; 0.1974; 0.1558; 0.1178; 0.0837; 0.0538; 0.0292; 0.023; 0.0181; 0.0146; 0.0124; 0.0117];
     
     % FFA-W3-211
     Cl_data_211 = [0; 0.05403; 0.10805; 0.16208; 0.2161; 0.27013; 0.32415; 0.37818; 0.4322; 0.48623; 0.54025; 0.59428; 0.6483; 0.70233; 0.75635; 0.73188; 0.70655; 0.6776; 0.64333; 0.60277; 0.5555; 0.50156; 0.44131; 0.37542; 0.30482; 0.23063; 0.15413; 0.07675; 0; -0.07675; -0.15413; -0.23063; -0.30482; -0.37542; -0.44131; -0.50156; -0.5555; -0.60277; -0.64333; -0.6776; -0.70655; -0.73188; -0.75635; -0.85636; -1.18292; -1.23596; -1.22536; -1.20476; -1.18332; -1.10093; -0.88209; -0.62981; -0.3767; -0.12177; 0.1281; 0.25192; 0.37535; 0.49828; 0.62052; 0.742; 0.86238; 0.98114; 1.09662; 1.20904; 1.3168; 1.42209; 1.52361; 1.61988; 1.70937; 1.78681; 1.8429; 1.85313; 1.80951; 1.66033; 1.56152; 1.43327; 1.29062; 1.0805; 1.04554; 1.00936; 0.96801; 0.91904; 0.86109; 0.79357; 0.71651; 0.63044; 0.53632; 0.43546; 0.32947; 0.22019; 0.10965; 0; -0.07675; -0.15413; -0.23063; -0.30482; -0.37542; -0.44131; -0.50156; -0.5555; -0.60277; -0.64333; -0.6776; -0.70655; -0.73188; -0.75635; -0.70233; -0.6483; -0.59428; -0.54025; -0.48623; -0.4322; -0.37818; -0.32415; -0.27013; -0.2161; -0.16208; -0.10805; -0.05403; 0];
     Cd_data_211 = [0.02464; 0.02534; 0.02742; 0.03088; 0.0357; 0.05599; 0.08143; 0.11112; 0.14485; 0.18242; 0.22359; 0.2681; 0.31566; 0.36597; 0.41871; 0.51941; 0.62488; 0.73293; 0.8413; 0.94773; 1.05001; 1.146; 1.23371; 1.31129; 1.37714; 1.42988; 1.46842; 1.49196; 1.5; 1.49196; 1.46842; 1.42988; 1.37714; 1.31129; 1.23371; 1.146; 1.05001; 0.94773; 0.8413; 0.73293; 0.62488; 0.51941; 0.41871; 0.28691; 0.1396; 0.08345; 0.06509; 0.04888; 0.03417; 0.02132; 0.01386; 0.01075; 0.00882; 0.00702; 0.00663; 0.00664; 0.0067; 0.00681; 0.00698; 0.0072; 0.00751; 0.00796; 0.00872; 0.00968; 0.01097; 0.01227; 0.01369; 0.01529; 0.01717; 0.01974; 0.02368; 0.03094; 0.04303; 0.0773; 0.11202; 0.18408; 0.27589; 0.41871; 0.51941; 0.62488; 0.73293; 0.8413; 0.94773; 1.05001; 1.146; 1.23371; 1.31129; 1.37714; 1.42988; 1.46842; 1.49196; 1.5; 1.49196; 1.46842; 1.42988; 1.37714; 1.31129; 1.23371; 1.146; 1.05001; 0.94773; 0.8413; 0.73293; 0.62488; 0.51941; 0.41871; 0.36597; 0.31566; 0.2681; 0.22359; 0.18242; 0.14485; 0.11112; 0.08143; 0.05599; 0.0357; 0.03088; 0.02742; 0.02534; 0.02464];
     
     % Table of Cl and Cd
     for i=1:2
     Cl_data(:,i)=Cl_data_cylinder;
     Cd_data(:,i)=Cd_data_cylinder;
     end
     
     for i=3:7
     Cl_data(:,i)=(Cl_data_500-Cl_data_cylinder)/(span(8)-span(2))*(span(i)-span(2))+Cl_data_cylinder;
     Cd_data(:,i)=(Cd_data_500-Cd_data_cylinder)/(span(8)-span(2))*(span(i)-span(2))+Cd_data_cylinder;
     end
     
     Cl_data(:,8)=Cl_data_500;
     Cd_data(:,8)=Cd_data_500;
     
     for i=9:12
     Cl_data(:,i)=(Cl_data_360-Cl_data_500)/(span(13)-span(8))*(span(i)-span(8))+Cl_data_500;
     Cd_data(:,i)=(Cd_data_360-Cd_data_500)/(span(13)-span(8))*(span(i)-span(8))+Cd_data_500;
     end
     
     Cl_data(:,13)=Cl_data_360;
     Cd_data(:,13)=Cd_data_360;
     
     for i=14:16
     Cl_data(:,i)=(Cl_data_330-Cl_data_360)/(span(17)-span(13))*(span(i)-span(13))+Cl_data_360;
     Cd_data(:,i)=(Cd_data_330-Cd_data_360)/(span(17)-span(13))*(span(i)-span(13))+Cd_data_360;
     end
     
     Cl_data(:,17)=Cl_data_330;
     Cd_data(:,17)=Cd_data_330;
     
     for i=18:21
     Cl_data(:,i)=(Cl_data_301-Cl_data_330)/(span(22)-span(17))*(span(i)-span(17))+Cl_data_330;
     Cd_data(:,i)=(Cd_data_301-Cd_data_330)/(span(22)-span(17))*(span(i)-span(17))+Cd_data_330;
     end
     
     Cl_data(:,22)=Cl_data_301;
     Cd_data(:,22)=Cd_data_301;
     
     for i=23:25
     Cl_data(:,i)=(Cl_data_270-Cl_data_301)/(span(26)-span(22))*(span(i)-span(22))+Cl_data_301;
     Cd_data(:,i)=(Cd_data_270-Cd_data_301)/(span(26)-span(22))*(span(i)-span(22))+Cd_data_301;
     end
     
     Cl_data(:,26)=Cl_data_270;
     Cd_data(:,26)=Cd_data_270;
     
     for i=27:30
     Cl_data(:,i)=(Cl_data_241-Cl_data_270)/(span(31)-span(26))*(span(i)-span(26))+Cl_data_270;
     Cd_data(:,i)=(Cd_data_241-Cd_data_270)/(span(31)-span(26))*(span(i)-span(26))+Cd_data_270;
     end
     
     Cl_data(:,31)=Cl_data_241;
     Cd_data(:,31)=Cd_data_241;
     
     for i=32:37
     Cl_data(:,i)=(Cl_data_211-Cl_data_241)/(span(38)-span(31))*(span(i)-span(31))+Cl_data_241;
     Cd_data(:,i)=(Cd_data_211-Cd_data_241)/(span(38)-span(31))*(span(i)-span(31))+Cd_data_241;
     end
     
     for i=38:50
     Cl_data(:,i)=Cl_data_211;
     Cd_data(:,i)=Cd_data_211;
     end
     
% BEM
    for i=1:size(span)-1
        a(i)=0; a_(i)=0; % Initialize axial and tangential induction factors
        for iteration=1:100
            phi(i)=atan((1-a(i))*V0/((1+a_(i))*span(i)*omega*pi/30))/pi*180;
            alpha(i)=phi(i)-twist(i)-pitch;
            Cl(i)=(Cl_data(sum(alpha_data<=alpha(i))+1,i)-Cl_data(sum(alpha_data<=alpha(i)),i))/(alpha_data(sum(alpha_data<=alpha(i))+1)-alpha_data(sum(alpha_data<=alpha(i))))*(alpha(i)-alpha_data(sum(alpha_data<=alpha(i))))+Cl_data(sum(alpha_data<=alpha(i)),i);
            Cd(i)=(Cd_data(sum(alpha_data<=alpha(i))+1,i)-Cd_data(sum(alpha_data<=alpha(i)),i))/(alpha_data(sum(alpha_data<=alpha(i))+1)-alpha_data(sum(alpha_data<=alpha(i))))*(alpha(i)-alpha_data(sum(alpha_data<=alpha(i))))+Cd_data(sum(alpha_data<=alpha(i)),i);
            Cn(i)=(Cl(i)*cos(phi(i)/180*pi)+Cd(i)*sin(phi(i)/180*pi))*cos(beta/180*pi);
            Ct(i)=Cl(i)*sin(phi(i)/180*pi)-Cd(i)*cos(phi(i)/180*pi);
            F(i)=2/pi*acos(exp(-nB/2*(120-span(i))/(span(i)*sin(phi(i)/180*pi))));
            K=(4*F(i)*(sin(phi(i)/180*pi))^2)/(nB*c(i)/(2*pi*span(i)*cos(beta/180*pi))*Cn(i)*cos(beta/180*pi));
            if a(i)<=0.2
                residual_1=abs(a(i)-1/(K+1));
                a(i)=1/(K+1);
            else
                residual_1=abs(a(i)-0.5*(2+K*(1-2*0.2)-((K*(1-2*0.2)+2)^2+4*(K*0.2^2-1))^0.5));
                a(i)=0.5*(2+K*(1-2*0.2)-((K*(1-2*0.2)+2)^2+4*(K*0.2^2-1))^0.5);
            end
            residual_2=abs(a_(i)-1/((4*F(i)*sin(phi(i)/180*pi)*cos(phi(i)/180*pi))/(nB*c(i)/(2*pi*span(i)*cos(beta/180*pi))*Ct(i))-1));
            a_(i)=1/((4*F(i)*sin(phi(i)/180*pi)*cos(phi(i)/180*pi))/(nB*c(i)/(2*pi*span(i)*cos(beta/180*pi))*Ct(i))-1);
            if max(residual_1,residual_2)<0.001
                break
            end
        end
        if iteration==100
            fprintf('The method doesn`t converge at blade elment %d after 100 iterations\n ', i)
        end
        pN(i)=Cn(i)*0.5*1.225*c(i)*((1-a(i))*V0*cos(beta/180*pi)/sin(phi(i)/180*pi))^2/10^3; 
        pT(i)=Ct(i)*0.5*1.225*c(i)*((1-a(i))*V0*cos(beta/180*pi)/sin(phi(i)/180*pi))^2/10^3;
        Re(i)=1.225*(1-a(i))*V0*cos(beta/180*pi)/sin(phi(i)/180*pi)*c(i)/(1.7894*10^(-5));
    end
    
    T=0;
    M=0;
    for i=1:size(span)-1
        A=(pN(i+1)-pN(i))/(span(i+1)-span(i));
        B=(pN(i)*span(i+1)-pN(i+1)*span(i))/(span(i+1)-span(i));
        C=(pT(i+1)-pT(i))/(span(i+1)-span(i));
        D=(pT(i)*span(i+1)-pT(i+1)*span(i))/(span(i+1)-span(i));
        T=T+nB*(0.5*A*(span(i+1)^2-span(i)^2)+B*(span(i+1)-span(i)));
        M=M+nB*cos(beta/180*pi)*(1/3*C*(span(i+1)^3-span(i)^3)+0.5*D*(span(i+1)^2-span(i)^2));
    end
    
    P=0.944*0.9655*omega*pi/30*M/1000;
